---
title: "02-ControlledTrials"
author: "Nicki lentz"
date: "8/3/2022"
output: html_document
editor_options: 
  chunk_output_type: console
---

#Libraries and data import

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(patchwork)
source("Scripts/PrettyConfusionMatrix.R")

FMPTuesdayNIU2 <- data.table::fread("Data/ProcessedData/FMPTuesdayNIU2.csv")
FMPTuesdayNIU3 <- data.table::fread("Data/ProcessedData/FMPTuesdayNIU3.csv")
FMPWednesdayNIU1 <- data.table::fread("Data/ProcessedData/FMPWednesdayNIU1.csv")
FMPThursdayNIU2 <- data.table::fread("Data/ProcessedData/FMPThursdayNIU2.csv")
FMPThursdayNIU3 <- data.table::fread("Data/ProcessedData/FMPThursdayNIU3.csv")

TuesdayNIU2gps <- data.table::fread("Data/ProcessedData/TuesdayNIU2gps.csv") %>% 
  filter(athlete %in% unique(FMPTuesdayNIU2$athlete))
TuesdayNIU3gps <- data.table::fread("Data/ProcessedData/TuesdayNIU3gps.csv") %>% 
  filter(athlete %in% unique(FMPTuesdayNIU3$athlete))
WednesdayNIU1gps <- data.table::fread("Data/ProcessedData/WednesdayNIU1gps.csv") %>% 
  filter(athlete %in% unique(FMPWednesdayNIU1$athlete))
ThursdayNIU2gps <- data.table::fread("Data/ProcessedData/ThursdayNIU2gps.csv") %>% 
  filter(athlete %in% unique(FMPThursdayNIU2$athlete))
ThursdayNIU3gps <- data.table::fread("Data/ProcessedData/ThursdayNIU3gps.csv") %>% 
  filter(athlete %in% unique(FMPThursdayNIU3$athlete))

#TuesdayNIU2imu <- data.table::fread("Data/ProcessedData/TuesdayNIU2imu.csv")
#TuesdayNIU3imu <- data.table::fread("Data/ProcessedData/TuesdayNIU3imu.csv")
#WednesdayNIU1imu <- data.table::fread("Data/ProcessedData/WednesdayNIU1imu.csv")
#ThursdayNIU2imu <- data.table::fread("Data/ProcessedData/ThursdayNIU2imu.csv")
#ThursdayNIU3imu <- data.table::fread("Data/ProcessedData/ThursdayNIU3imu.csv")
```

# Functions

```{r}
#Syncing the GPS and FMP data to create a FMP prediction algorithms based on velocity. Though without 
#considering dynamic movements as this function is only applicable to linear locomotion scenarios. 
LinearFMPtruth <- function(GPSdata, FMPdata, event, groupID, startTime, endTime){
  
  syncGPSData <- GPSdata %>%
    filter(unixTime >= startTime,
           unixTime <= endTime) %>% 
    arrange(athlete, unixTime)
  
  syncFMPData <- FMPdata %>% 
    filter(unixTime >= startTime,
           unixTime <= endTime) %>% 
    arrange(athlete, unixTime)
  
  
  #Rolling average with no overlap, to turn 10hz data to 1hz
  syncGPSData$VelRollMean <- ave(syncGPSData$velocity, syncGPSData$athlete, 
                                 FUN = function(x) zoo::rollapply(x, width = 10, FUN = mean, by = 10, fill = NA))
  
  #For some reason there is one second extra data in the gps signal than in the FMP, so we will remove it.
  syncGPSData <- syncGPSData %>% 
    na.omit() %>% 
    select(athlete, unixTime, date_time, VelRollMean) %>% 
    filter(unixTime != as.numeric(lubridate::as_datetime(endTime)))
  
  #Adding the velocity to the FMP data. For some reason join() functions return NA values for the velocity,
  #but because everything is arranged based on athlete and date_time we can simply add the vector.
  syncFMPData$velocity <- syncGPSData$VelRollMean 
  
  #Prediction rules based on Sweeting et al 2017 - When is a sprint a sprint
  #multiplyed by 3.6 as the thresholds is given in m/s and we want it in km/h
  
  FMPtruth <- syncFMPData %>% 
    mutate(truth = case_when(
      velocity <= (0.17*3.6) ~ "Very Low Intensity",
      velocity > (0.17*3.6) & velocity <= (1.97*3.6) ~ "Low Intensity",
      velocity > (1.97*3.6) & velocity <= (3.97*3.6) ~ "Running Medium Intensity",
      velocity > (3.97*3.6) ~ "Running High Intensity"
    ),
    event = event,
    athlete = paste(groupID, athlete, sep = "_"))
  
  
  
  
  FMPtruth$truth <- factor(FMPtruth$truth, levels = c("Very Low Intensity",
                                                      "Low Intensity",
                                                      "Dynamic Medium Intensity",
                                                      "Dynamic High Intensity",
                                                      "Running Medium Intensity",
                                                      "Running High Intensity"))
  
  FMPtruth$movement_type <- factor(FMPtruth$movement_type, levels = c("Very Low Intensity",
                                                      "Low Intensity",
                                                      "Dynamic Medium Intensity",
                                                      "Dynamic High Intensity",
                                                      "Running Medium Intensity",
                                                      "Running High Intensity"))
  
  return(FMPtruth)
}

NonLinearFMPtruth <- function(GPSdata, FMPdata, event, groupID, startTime, endTime){
  
  athlete_name <- gsub(".*?_", "", event)
  dynamic <- gsub("\\_.*", "", event)
  
  syncGPSData <- GPSdata %>%
    filter(athlete == athlete_name,
           unixTime >= startTime,
           unixTime <= endTime) %>% 
    arrange(athlete, unixTime)
  
  syncFMPData <- FMPdata %>% 
    filter(athlete == athlete_name,
           unixTime >= startTime,
           unixTime <= endTime) %>% 
    arrange(athlete, unixTime)
  
  #Rolling average with no overlap, to turn 10hz data to 1hz
  syncGPSData$VelRollMean <- ave(syncGPSData$velocity, syncGPSData$athlete, 
                                 FUN = function(x) zoo::rollapply(x, width = 10, FUN = mean, by = 10, fill = NA))
  
  #For some reason there is one second extra data in the gps signal than in the FMP, so we will remove it.
  syncGPSData <- syncGPSData %>% 
    na.omit() %>% 
    select(athlete, unixTime, VelRollMean) %>% 
    filter(unixTime != as.numeric(lubridate::as_datetime(endTime)))
  
  #Adding the velocity to the FMP data. For some reason join() functions return NA values for the velocity,
  #but because everything is arranged based on athlete and date_time we can simply add the vector.
  syncFMPData$velocity <- syncGPSData$VelRollMean
  
  FMPtruth <- syncFMPData %>% 
    mutate(truth = case_when(
      dynamic == "medium" ~ "Dynamic Medium Intensity",
      dynamic == "high" ~ "Dynamic High Intensity"
    ),
    event = event,
    athlete = paste(groupID, athlete, sep = "_"))
  
  
  
  
  FMPtruth$truth <- factor(FMPtruth$truth, levels = c("Very Low Intensity",
                                                      "Low Intensity",
                                                      "Dynamic Medium Intensity",
                                                      "Dynamic High Intensity",
                                                      "Running Medium Intensity",
                                                      "Running High Intensity"))
  
    FMPtruth$movement_type <- factor(FMPtruth$movement_type, levels = c("Very Low Intensity",
                                                      "Low Intensity",
                                                      "Dynamic Medium Intensity",
                                                      "Dynamic High Intensity",
                                                      "Running Medium Intensity",
                                                      "Running High Intensity"))
  
  return(FMPtruth)
}

lineFMPPlot <- function(data, drillType, nCol = 3){
  
  if (drillType == "linear") {
    sub = "Tiles represents the prediction from FMP and the dots on the velocity curve 
    represents the truth based on velocity thresholds"
  } else if (drillType == "nonlinear"){
    sub = "Tiles represents the prediction from FMP and the dots on the velocity curve
    represents the truth based on visual assessment"
  }
  
  data %>% 
    ggplot() + 
    geom_tile(aes(x = unixTime, y = movement_type, fill = movement_type), 
              colour = "black", width = 0.85, height = 0.85, size = 1) + 
    geom_line(aes(x = unixTime, y = velocity)) + 
    geom_point(aes(x = unixTime, y = velocity, color = truth), size = 3, show.legend = FALSE) + 
    facet_wrap(~athlete, scale = "free_x", ncol = nCol) + 
    theme_minimal() + 
    theme(legend.position = "top",
          axis.text.y = element_blank(),
          axis.text.x = element_blank()) + 
    scale_fill_manual("", values=c("Very Low Intensity"="#313131", "Low Intensity"="#0f3698", 
                               "Dynamic Medium Intensity"="#94281b", "Dynamic High Intensity"="#e65036",
                               "Running Medium Intensity"="#3c8001", "Running High Intensity"="#65e114")) + 
    scale_color_manual(values=c("Very Low Intensity"="#313131", "Low Intensity"="#0f3698", 
                                "Dynamic Medium Intensity"="#94281b", "Dynamic High Intensity"="#e65036",
                                "Running Medium Intensity"="#3c8001", "Running High Intensity"="#65e114")) + 
    labs(title = "Velocity and Football movement profile",
         subtitle = sub) + 
    ylab("Football Movement Profile") + 
    xlab("")
}
```

# TuesdayNIU2 Walk

```{r}
Tuesday_NIU2_Walk2 <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                      event = "Walk2", groupID = "TuesdayNIU2",
                        startTime = as.numeric(lubridate::as_datetime("2022-02-15 08:31:10 UTC")),
                        endTime = as.numeric(lubridate::as_datetime("2022-02-15 08:31:53 UTC")))

Tuesday_NIU2_Walk3 <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                      event = "Walk3", groupID = "TuesdayNIU2",
                        startTime = lubridate::as_datetime("2022-02-15 08:32:07 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 08:32:49 UTC"))

Tuesday_NIU2_Walk4 <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                      event = "Walk4", groupID = "TuesdayNIU2",
                        startTime = lubridate::as_datetime("2022-02-15 08:33:04 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 08:33:47 UTC"))

Tuesday_NIU2_Walk5 <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                      event = "Walk5", groupID = "TuesdayNIU2",
                        startTime = lubridate::as_datetime("2022-02-15 08:34:02 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 08:34:43 UTC"))


Tuesday_NIU2_Walk <- rbind(Tuesday_NIU2_Walk2,
                            Tuesday_NIU2_Walk3,
                            Tuesday_NIU2_Walk4,
                            Tuesday_NIU2_Walk5)

Tuesday_NIU2_Walk %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU2_Walk5, drillType = "linear")
ggsave("Output/Visualization/Tuesday_NIU2_Walk5.jpeg", width = 25, height = 10)

PrettyConfusionMatrix(Tuesday_NIU2_Walk$truth, Tuesday_NIU2_Walk$movement_type)
```

# TuesdayNIU2 Run 10m/3sec

```{r}
Tuesday_NIU2_Run10_2 <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                        event = "Run10_2", groupID = "TuesdayNIU2",
                          startTime = lubridate::as_datetime("2022-02-15 08:37:37 UTC"),
                          endTime = lubridate::as_datetime("2022-02-15 08:37:55 UTC"))

Tuesday_NIU2_Run10_3  <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                        event = "Run10_3", groupID = "TuesdayNIU2",
                           startTime = lubridate::as_datetime("2022-02-15 08:38:10 UTC"),
                           endTime = lubridate::as_datetime("2022-02-15 08:38:28 UTC"))

Tuesday_NIU2_Run10_4  <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                        event = "Run10_4", groupID = "TuesdayNIU2",
                           startTime = lubridate::as_datetime("2022-02-15 08:38:43 UTC"),
                           endTime = lubridate::as_datetime("2022-02-15 08:39:01 UTC"))

Tuesday_NIU2_Run10_5  <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                        event = "Run10_5", groupID = "TuesdayNIU2",
                           startTime = lubridate::as_datetime("2022-02-15 08:39:16 UTC"),
                           endTime = lubridate::as_datetime("2022-02-15 08:39:34 UTC"))


Tuesday_NIU2_Run10 <- rbind(Tuesday_NIU2_Run10_2,
                             Tuesday_NIU2_Run10_3,
                             Tuesday_NIU2_Run10_4,
                             Tuesday_NIU2_Run10_5)

Tuesday_NIU2_Run10 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU2_Run10_5, drillType = "linear")
ggsave("Output/Visualization/Tuesday_NIU2_Run10_5.jpeg", width = 25, height = 10)
```

# TuesdayNIU2 Run 15m/3sec

```{r}
Tuesday_NIU2_Run15_2 <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                       event = "Run15_2", groupID = "TuesdayNIU2",
                          startTime = lubridate::as_datetime("2022-02-15 08:45:29 UTC"),
                          endTime = lubridate::as_datetime("2022-02-15 08:45:40 UTC"))

Tuesday_NIU2_Run15_3  <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                       event = "Run15_3", groupID = "TuesdayNIU2",
                           startTime = lubridate::as_datetime("2022-02-15 08:45:56 UTC"),
                           endTime = lubridate::as_datetime("2022-02-15 08:46:07 UTC"))

Tuesday_NIU2_Run15_4  <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                       event = "Run15_4", groupID = "TuesdayNIU2",
                           startTime = lubridate::as_datetime("2022-02-15 08:46:23 UTC"),
                           endTime = lubridate::as_datetime("2022-02-15 08:46:34 UTC"))

Tuesday_NIU2_Run15_5  <- LinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, 
                                       event = "Run15_5", groupID = "TuesdayNIU2",
                           startTime = lubridate::as_datetime("2022-02-15 08:46:49 UTC"),
                           endTime = lubridate::as_datetime("2022-02-15 08:47:00 UTC"))


Tuesday_NIU2_Run15 <- rbind(Tuesday_NIU2_Run15_2,
               Tuesday_NIU2_Run15_3,
               Tuesday_NIU2_Run15_4,
               Tuesday_NIU2_Run15_5)

Tuesday_NIU2_Run15 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU2_Run15_5, drillType = "linear")
ggsave("Output/Visualization/Tuesday_NIU_Walk15_5.jpeg", width = 25, height = 10)

```

# TuesdayNIU2 Medium Dynamic

```{r}
Tuesday_NIU2_medium_Yellow2 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-2", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:02:40 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:22 UTC")))

Tuesday_NIU2_medium_Yellow3 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-3", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:02:48 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:35 UTC")))

Tuesday_NIU2_medium_Yellow5 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-5", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:02:57 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:39 UTC")))

Tuesday_NIU2_medium_Yellow6 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-6", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:09 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:51 UTC")))

Tuesday_NIU2_medium_Yellow7 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-7", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:18 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:57 UTC")))

Tuesday_NIU2_medium_Yellow8 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-8", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("22022-02-15 09:03:27 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:07 UTC")))

Tuesday_NIU2_medium_Yellow9 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-9", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:37 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:17 UTC")))

Tuesday_NIU2_medium_Yellow10 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Yellow-10", groupID = "TuesdayNIU2",
                                     startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:42 UTC")),
                                     endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:28 UTC")))

Tuesday_NIU2_medium_Orange2 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Orange-2", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:03:55 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:40 UTC")))

Tuesday_NIU2_medium_Orange3 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Orange-3",groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:01 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:41 UTC")))

Tuesday_NIU2_medium_Orange4 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Orange-4",groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:12 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:57 UTC")))

Tuesday_NIU2_medium_Orange5 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Orange-5",groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:24 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:05:11 UTC")))

Tuesday_NIU2_medium_Orange6 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Orange-6", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:34 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:05:14 UTC")))

Tuesday_NIU2_medium_Orange7 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2,"medium_Orange-7", groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:40 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:05:19 UTC")))

Tuesday_NIU2_medium_Orange8 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "medium_Orange-8",groupID = "TuesdayNIU2",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:04:49 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:05:26 UTC")))

Tuesday_NIU2_mediumDynamic <- rbind(Tuesday_NIU2_medium_Yellow2, 
                                    Tuesday_NIU2_medium_Yellow3, 
                                    Tuesday_NIU2_medium_Yellow5, 
                                    Tuesday_NIU2_medium_Yellow6, 
                                    Tuesday_NIU2_medium_Yellow7,
                                    Tuesday_NIU2_medium_Yellow8, 
                                    Tuesday_NIU2_medium_Yellow9, 
                                    Tuesday_NIU2_medium_Yellow10, 
                                    Tuesday_NIU2_medium_Orange2, 
                                    Tuesday_NIU2_medium_Orange3,
                                    Tuesday_NIU2_medium_Orange4, 
                                    Tuesday_NIU2_medium_Orange5, 
                                    Tuesday_NIU2_medium_Orange6, 
                                    Tuesday_NIU2_medium_Orange7, 
                                    Tuesday_NIU2_medium_Orange8)

Tuesday_NIU2_mediumDynamic %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU2_mediumDynamic, drillType = "nonlinear")
ggsave("Output/Visualization/Tuesday_NIU2_mediumDynamic.jpeg", width = 25, height = 10)

PrettyConfusionMatrix(Tuesday_NIU2_mediumDynamic$truth, Tuesday_NIU2_mediumDynamic$movement_type)
```

# TuesdayNIU2 High Dynamic

```{r}
Tuesday_NIU2_high_Yellow2 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-2", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:06:55 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:07:31 UTC"))

Tuesday_NIU2_high_Yellow3 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-3", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:07:04 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:07:40 UTC"))

Tuesday_NIU2_high_Yellow5 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-5", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:07:13 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:07:49"))

Tuesday_NIU2_high_Yellow6 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-6", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:07:22 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:07:53 UTC"))

Tuesday_NIU2_high_Yellow7 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-7", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:07:30 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:08:01 UTC"))

Tuesday_NIU2_high_Yellow8 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-8", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:07:38 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:08:07 UTC"))

Tuesday_NIU2_high_Yellow9 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-9", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:07:46 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:08:17 UTC"))

Tuesday_NIU2_high_Yellow10 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-10", groupID = "TuesdayNIU2",
                                   startTime = lubridate::as_datetime("2022-02-15 09:07:53 UTC"),
                                   endTime = lubridate::as_datetime("2022-02-15 09:08:21 UTC"))

Tuesday_NIU2_high_Orange2 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-2", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:00 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:08:33 UTC"))

Tuesday_NIU2_high_Orange3 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-3", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:13 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:08:44 UTC"))

Tuesday_NIU2_high_Orange4 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-4", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:21 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:08:53 UTC"))

Tuesday_NIU2_high_Orange5 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-5", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:28 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:09:02 UTC"))

Tuesday_NIU2_high_Orange6 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-6", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:36 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:09:03 UTC"))

Tuesday_NIU2_high_Orange7 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2,"high_Orange-7", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:43 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:09:07 UTC"))

Tuesday_NIU2_high_Orange8 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-8", groupID = "TuesdayNIU2",
                                  startTime = lubridate::as_datetime("2022-02-15 09:08:49 UTC"),
                                  endTime = lubridate::as_datetime("2022-02-15 09:09:19 UTC"))

Tuesday_NIU2_highDynamic <- rbind(Tuesday_NIU2_high_Yellow2, 
                                  Tuesday_NIU2_high_Yellow3, 
                                  Tuesday_NIU2_high_Yellow5, 
                                  Tuesday_NIU2_high_Yellow6, 
                                  Tuesday_NIU2_high_Yellow7,
                                  Tuesday_NIU2_high_Yellow8,
                                  Tuesday_NIU2_high_Yellow9,
                                  Tuesday_NIU2_high_Yellow10,
                                  Tuesday_NIU2_high_Orange2,
                                  Tuesday_NIU2_high_Orange3,
                                  Tuesday_NIU2_high_Orange4, 
                                  Tuesday_NIU2_high_Orange5, 
                                  Tuesday_NIU2_high_Orange6, 
                                  Tuesday_NIU2_high_Orange7, 
                                  Tuesday_NIU2_high_Orange8)

Tuesday_NIU2_highDynamic %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU2_highDynamic, drillType = "nonlinear")
ggsave("Output/Visualization/Tuesday_NIU2_highDynamic.jpeg", width = 25, height = 10)

PrettyConfusionMatrix(Tuesday_NIU2_highDynamic$truth, Tuesday_NIU2_highDynamic$movement_type)
```

# TuesdayNIU2 High Half Dynamic

```{r}
Tuesday_NIU2_highHalf_Yellow2 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-2", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:19 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:35 UTC")))

Tuesday_NIU2_highHalf_Yellow3 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-3", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:24 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:41 UTC")))

Tuesday_NIU2_highHalf_Yellow5 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-5", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:30 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:47 UTC")))

Tuesday_NIU2_highHalf_Yellow6 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-6", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:36 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:51 UTC")))

Tuesday_NIU2_highHalf_Yellow7 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-7", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:43 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:59 UTC")))

Tuesday_NIU2_highHalf_Yellow8 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-8", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:10:55 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:10 UTC")))

Tuesday_NIU2_highHalf_Yellow9 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-9", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:01 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:16 UTC")))

Tuesday_NIU2_highHalf_Yellow10 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Yellow-10", groupID = "TuesdayNIU2",
                                       startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:07 UTC")),
                                       endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:22 UTC")))

Tuesday_NIU2_highHalf_Orange2 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-2", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:14 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:30 UTC")))

Tuesday_NIU2_highHalf_Orange3 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-3",groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:22 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:38 UTC")))

Tuesday_NIU2_highHalf_Orange4 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-4",groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:28 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:44 UTC")))

Tuesday_NIU2_highHalf_Orange5 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-5",groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:35 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:51 UTC")))

Tuesday_NIU2_highHalf_Orange6 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-6", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:42 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:57 UTC")))

Tuesday_NIU2_highHalf_Orange7 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2,"high_Orange-7", groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:48 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:12:03 UTC")))

Tuesday_NIU2_highHalf_Orange8 <- NonLinearFMPtruth(TuesdayNIU2gps, FMPTuesdayNIU2, "high_Orange-8",groupID = "TuesdayNIU2",
                                      startTime = as.numeric(lubridate::as_datetime("2022-02-15 09:11:54 UTC")),
                                      endTime = as.numeric(lubridate::as_datetime("2022-02-15 09:12:10 UTC")))

Tuesday_NIU2_highHalfDynamic <- rbind(Tuesday_NIU2_highHalf_Yellow2, 
                                      Tuesday_NIU2_highHalf_Yellow3, 
                                      Tuesday_NIU2_highHalf_Yellow5, 
                                      Tuesday_NIU2_highHalf_Yellow6, 
                                      Tuesday_NIU2_highHalf_Yellow7,
                                      Tuesday_NIU2_highHalf_Yellow8, 
                                      Tuesday_NIU2_highHalf_Yellow9, 
                                      Tuesday_NIU2_highHalf_Yellow10, 
                                      Tuesday_NIU2_highHalf_Orange2, 
                                      Tuesday_NIU2_highHalf_Orange3,
                                      Tuesday_NIU2_highHalf_Orange4,
                                      Tuesday_NIU2_highHalf_Orange5, 
                                      Tuesday_NIU2_highHalf_Orange6, 
                                      Tuesday_NIU2_highHalf_Orange7, 
                                      Tuesday_NIU2_highHalf_Orange8)

Tuesday_NIU2_highHalfDynamic %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU2_highHalfDynamic, drillType = "nonlinear")
ggsave("Output/Visualization/Tuesday_NIU2_highHalfDynamic.jpeg", width = 25, height = 10)
```

# TuesdayNIU3 Walk

```{r}
Tuesday_NIU3_Walk2 <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                      event = "Walk2", groupID = "TuesdayNIU3",
                        startTime = lubridate::as_datetime("2022-02-15 10:20:10 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 10:20:50 UTC"))

Tuesday_NIU3_Walk3 <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                      event = "Walk3", groupID = "TuesdayNIU3",
                        startTime = lubridate::as_datetime("2022-02-15 10:21:03 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 10:21:43 UTC"))

Tuesday_NIU3_Walk4 <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                      event = "Walk4", groupID = "TuesdayNIU3",
                        startTime = lubridate::as_datetime("2022-02-15 10:21:57 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 10:22:37 UTC"))

Tuesday_NIU3_Walk5 <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                      event = "Walk5", groupID = "TuesdayNIU3",
                        startTime = lubridate::as_datetime("2022-02-15 10:22:50 UTC"),
                        endTime = lubridate::as_datetime("2022-02-15 10:23:30 UTC"))


Tuesday_NIU3_Walk <- rbind(Tuesday_NIU3_Walk2,
                            Tuesday_NIU3_Walk3,
                            Tuesday_NIU3_Walk4,
                            Tuesday_NIU3_Walk5)

Tuesday_NIU3_Walk %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_Walk2, drillType = "linear")
```

# TuesdayNIU3 Run 10m/3sec

```{r}
Tuesday_NIU3_Run10_3 <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run10_3", groupID = "TuesdayNIU3",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:27:12 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:27:30 UTC")))

Tuesday_NIU3_Run10_4  <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run10_4", groupID = "TuesdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:27:42 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:28:00 UTC")))

Tuesday_NIU3_Run10_5  <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run10_5", groupID = "TuesdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:28:12 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:28:30 UTC")))

Tuesday_NIU3_Run10_6  <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run10_6", groupID = "TuesdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:28:43 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:29:01 UTC")))


Tuesday_NIU3_Run10 <- rbind(Tuesday_NIU3_Run10_3,
                             Tuesday_NIU3_Run10_4,
                             Tuesday_NIU3_Run10_5,
                             Tuesday_NIU3_Run10_6)

Tuesday_NIU3_Run10 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_Run10_4, drillType = "linear")
```

# TuesdayNIU3 Run 15m/3sec

```{r}
Tuesday_NIU3_Run15_2 <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run15_2", groupID = "TuesdayNIU3",
                          startTime = as.numericlubridate::as_datetime("2022-02-15 10:39:35 UTC")),
                          endTime = as.numericlubridate::as_datetime("2022-02-15 10:39:41 UTC")))

Tuesday_NIU3_Run15_3  <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run15_3", groupID = "TuesdayNIU3",
                           startTime = as.numericlubridate::as_datetime("2022-02-15 10:40:02 UTC")),
                           endTime = as.numericlubridate::as_datetime("2022-02-15 10:40:08 UTC")))

Tuesday_NIU3_Run15_4  <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run15_4", groupID = "TuesdayNIU3",
                           startTime = as.numericlubridate::as_datetime("2022-02-15 10:40:29 UTC")),
                           endTime = as.numericlubridate::as_datetime("2022-02-15 10:40:35 UTC")))

Tuesday_NIU3_Run15_5  <- LinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, 
                                       event = "Run15_5", groupID = "TuesdayNIU3",
                           startTime = as.numericlubridate::as_datetime("2022-02-15 10:40:58 UTC")),
                           endTime = as.numericlubridate::as_datetime("2022-02-15 10:41:04 UTC")))


Tuesday_NIU3_Run15 <- rbind(Tuesday_NIU3_Run15_2,
               Tuesday_NIU3_Run15_3,
               Tuesday_NIU3_Run15_4,
               Tuesday_NIU3_Run15_5)

Tuesday_NIU3_Run15 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_Run15_3, drillType = "linear")

```

# TuesdayNIU3 Medium Dynamic 1

```{r}
Tuesday_NIU3_medium_Orange2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:48:35 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:20 UTC")))

Tuesday_NIU3_medium_Orange4 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-4", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:48:49 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:34 UTC")))

Tuesday_NIU3_medium_Orange5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:01 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:47 UTC")))

Tuesday_NIU3_medium_Yellow2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:17 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:50:04 UTC")))

Tuesday_NIU3_medium_Yellow3 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-3", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:31 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:50:19 UTC")))

Tuesday_NIU3_medium_Yellow5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:49:46 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:50:31 UTC")))

Tuesday_NIU3_medium_Yellow6 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-6", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:50:02 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:50:48 UTC")))



Tuesday_NIU3_mediumDynamic <- rbind(Tuesday_NIU3_medium_Orange2, 
                                    Tuesday_NIU3_medium_Orange4, 
                                    Tuesday_NIU3_medium_Orange5,
                                    Tuesday_NIU3_medium_Yellow2, 
                                    Tuesday_NIU3_medium_Yellow3, 
                                    Tuesday_NIU3_medium_Yellow5, 
                                    Tuesday_NIU3_medium_Yellow6)

Tuesday_NIU3_mediumDynamic %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_mediumDynamic, drillType = "nonlinear")

```

# TuesdayNIU3 Medium Dynamic 2

```{r}
Tuesday_NIU3_medium2_Orange2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:52:11 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:52:57 UTC")))

Tuesday_NIU3_medium2_Orange4 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-4",groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:52:26 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:11 UTC")))

Tuesday_NIU3_medium2_Orange5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-5",groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:52:37 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:22 UTC")))

Tuesday_NIU3_medium2_Yellow2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:52:53 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:40 UTC")))

Tuesday_NIU3_medium2_Yellow3 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-3", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:08 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:54 UTC")))

Tuesday_NIU3_medium2_Yellow5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:20 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:54:05 UTC")))

Tuesday_NIU3_medium2_Yellow6 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-6", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:53:37 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:54:23 UTC")))


Tuesday_NIU3_mediumDynamic2 <- rbind(Tuesday_NIU3_medium2_Orange2, 
                                    Tuesday_NIU3_medium2_Orange4, 
                                    Tuesday_NIU3_medium2_Orange5,
                                    Tuesday_NIU3_medium2_Yellow2, 
                                    Tuesday_NIU3_medium2_Yellow3, 
                                    Tuesday_NIU3_medium2_Yellow5, 
                                    Tuesday_NIU3_medium2_Yellow6)

Tuesday_NIU3_mediumDynamic2 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_mediumDynamic2, drillType = "nonlinear")
```

# TuesdayNIU3 Medium Dynamic (No mid cones)

```{r}
Tuesday_NIU3_noCone_Orange2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:55:10 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:55:56 UTC")))

Tuesday_NIU3_noCone_Orange4 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-4",groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:55:24 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:10 UTC")))

Tuesday_NIU3_noCone_Orange5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Orange-5",groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:55:36 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:23 UTC")))

Tuesday_NIU3_noCone_Yellow2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:55:49 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:36 UTC")))

Tuesday_NIU3_noCone_Yellow3 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-3", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:04 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:51 UTC")))

Tuesday_NIU3_noCone_Yellow5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:18 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:57:04 UTC")))

Tuesday_NIU3_noCone_Yellow6 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "medium_Yellow-6", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:56:33 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:57:19 UTC")))



Tuesday_NIU3_noCone <- rbind(Tuesday_NIU3_noCone_Orange2, 
                                    Tuesday_NIU3_noCone_Orange4, 
                                    Tuesday_NIU3_noCone_Orange5,
                                    Tuesday_NIU3_noCone_Yellow2, 
                                    Tuesday_NIU3_noCone_Yellow3, 
                                    Tuesday_NIU3_noCone_Yellow5, 
                                    Tuesday_NIU3_noCone_Yellow6)

Tuesday_NIU3_noCone %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_noCone, drillType = "nonlinear")
```

# TuesdayNIU3 High Dynamic

```{r}
Tuesday_NIU3_high_Orange2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Orange-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:58:33 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:12 UTC")))

Tuesday_NIU3_high_Orange4 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Orange-4", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:58:53 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:24 UTC")))

Tuesday_NIU3_high_Orange5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Orange-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:05 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:37 UTC")))

Tuesday_NIU3_high_Yellow2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:17 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:52 UTC")))

Tuesday_NIU3_high_Yellow3 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-3", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:32 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:00:10 UTC")))

Tuesday_NIU3_high_Yellow5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 10:59:47 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:00:19 UTC")))

Tuesday_NIU3_high_Yellow6 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-6", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:00:03 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:00:33 UTC")))



Tuesday_NIU3_highDynamic <- rbind(Tuesday_NIU3_high_Orange2, 
                                    Tuesday_NIU3_high_Orange4, 
                                    Tuesday_NIU3_high_Orange5,
                                    Tuesday_NIU3_high_Yellow2, 
                                    Tuesday_NIU3_high_Yellow3, 
                                    Tuesday_NIU3_high_Yellow5, 
                                    Tuesday_NIU3_high_Yellow6)

Tuesday_NIU3_highDynamic %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_highDynamic, drillType = "nonlinear", nCol = 2)
```

# TuesdayNIU3 High Half Dynamic

```{r}
Tuesday_NIU3_highHalf_Orange2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Orange-2",groupID = "TuesdayNIU3", 
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:06:14 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:06:32 UTC")))

Tuesday_NIU3_highHalf_Orange4 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Orange-4",groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:06:52 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:07:07 UTC")))

Tuesday_NIU3_highHalf_Orange5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Orange-5",groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:07:23 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:07:39 UTC")))

Tuesday_NIU3_highHalf_Yellow2 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-2", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:07:51 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:08:07 UTC")))

Tuesday_NIU3_highHalf_Yellow3 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-3", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:08:25 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:08:42 UTC")))

Tuesday_NIU3_highHalf_Yellow5 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-5", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:09:05 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:09:19 UTC")))

Tuesday_NIU3_highHalf_Yellow6 <- NonLinearFMPtruth(TuesdayNIU3gps, FMPTuesdayNIU3, "high_Yellow-6", groupID = "TuesdayNIU3",
                                    startTime = as.numeric(lubridate::as_datetime("2022-02-15 11:09:41 UTC")),
                                    endTime = as.numeric(lubridate::as_datetime("2022-02-15 11:09:56 UTC")))



Tuesday_NIU3_highHalf <- rbind(Tuesday_NIU3_highHalf_Orange2, 
                                    Tuesday_NIU3_highHalf_Orange4, 
                                    Tuesday_NIU3_highHalf_Orange5,
                                    Tuesday_NIU3_highHalf_Yellow2, 
                                    Tuesday_NIU3_highHalf_Yellow3, 
                                    Tuesday_NIU3_highHalf_Yellow5, 
                                    Tuesday_NIU3_highHalf_Yellow6)

Tuesday_NIU3_highHalf %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Tuesday_NIU3_highHalf, drillType = "nonlinear")
```

# WednesdayNIU1 Run 10m/3sec

```{r}
Wednesday_NIU1_Run10_1 <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run10_1", groupID = "WednesdayNIU1",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:32:34 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:32:46 UTC")))

Wednesday_NIU1_Run10_2  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run10_2", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:33:04 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:33:16 UTC")))

Wednesday_NIU1_Run10_3  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run10_3", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:33:32 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:33:44 UTC")))

Wednesday_NIU1_Run10_4  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run10_4", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:33:58 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:34:10 UTC")))


Wednesday_NIU1_Run10 <- rbind(Wednesday_NIU1_Run10_1,
                             Wednesday_NIU1_Run10_2,
                             Wednesday_NIU1_Run10_3,
                             Wednesday_NIU1_Run10_4)

Wednesday_NIU1_Run10 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Wednesday_NIU1_Run10_4, drillType = "linear")
```

# WednesdayNIU1 Run 15m/3sec

```{r}
Wednesday_NIU1_Run15_1 <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run15_1", groupID = "WednesdayNIU1",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:40:30 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:40:36 UTC")))

Wednesday_NIU1_Run15_2  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run15_2", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:40:54 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:41:00 UTC")))

Wednesday_NIU1_Run15_3  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run15_3", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:41:21 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:41:27 UTC")))

Wednesday_NIU1_Run15_4  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run15_4", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:41:45 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:41:51 UTC")))


Wednesday_NIU1_Run15 <- rbind(Wednesday_NIU1_Run15_1,
                             Wednesday_NIU1_Run15_2,
                             Wednesday_NIU1_Run15_3,
                             Wednesday_NIU1_Run15_4)

Wednesday_NIU1_Run15 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Wednesday_NIU1_Run15_4, drillType = "linear")
```

# WednesdayNIU1 Run 16.5m / 3 sec

```{r}
Wednesday_NIU1_Run16_1 <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run16_1", groupID = "WednesdayNIU1",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:47:09 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:47:15 UTC")))

Wednesday_NIU1_Run16_2  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run16_2", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:47:34 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:47:40 UTC")))

Wednesday_NIU1_Run16_3  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run16_3", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:48:01 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:48:07 UTC")))

Wednesday_NIU1_Run16_4  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run16_4", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:48:28 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:48:34 UTC")))


Wednesday_NIU1_Run16 <- rbind(Wednesday_NIU1_Run16_1,
                             Wednesday_NIU1_Run16_2,
                             Wednesday_NIU1_Run16_3,
                             Wednesday_NIU1_Run16_4)

Wednesday_NIU1_Run16 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Wednesday_NIU1_Run16_4, drillType = "linear")
```

# WednesdayNIU 1 Run 18m / 3 sec

```{r}
Wednesday_NIU1_Run18_1 <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run18_1", groupID = "WednesdayNIU1",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:54:27 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:54:33 UTC")))

Wednesday_NIU1_Run18_2  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run18_2", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:54:58 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:55:04 UTC")))

Wednesday_NIU1_Run18_3  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run18_3", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:55:30 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:55:36 UTC")))

Wednesday_NIU1_Run18_4  <- LinearFMPtruth(WednesdayNIU1gps, FMPWednesdayNIU1, 
                                        event = "Run18_4", groupID = "WednesdayNIU1",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-16 08:56:02 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-16 08:56:08 UTC")))


Wednesday_NIU1_Run18 <- rbind(Wednesday_NIU1_Run18_1,
                             Wednesday_NIU1_Run18_2,
                             Wednesday_NIU1_Run18_3,
                             Wednesday_NIU1_Run18_4)

Wednesday_NIU1_Run18 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Wednesday_NIU1_Run18_4, drillType = "linear")
```


# ThursdayNIU2 Run 15m / 3 sec

```{r}
Thursday_NIU2_Run15_1 <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run15_1", groupID = "ThursdayNIU2",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:26:07 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:26:13 UTC")))

Thursday_NIU2_Run15_2  <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run15_2", groupID = "ThursdayNIU2",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:26:35 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:26:41 UTC")))
Thursday_NIU2_Run15_3  <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run15_3", groupID = "ThursdayNIU2",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:27:01 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:27:07 UTC")))

Thursday_NIU2_Run15 <- rbind(Thursday_NIU2_Run15_1,
                             Thursday_NIU2_Run15_2,
                             Thursday_NIU2_Run15_3)
Thursday_NIU2_Run15 %>%
  select(truth, movement_type) %>%
  irr::agree(.)

lineFMPPlot(Thursday_NIU2_Run15_3, drillType = "linear")
```

# ThursdayNIU2 Run 16.5m / 3sec

```{r}
Thursday_NIU2_Run16_1 <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run16_1", groupID = "ThursdayNIU2",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:29:39 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:29:45 UTC")))

Thursday_NIU2_Run16_2  <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run16_2", groupID = "ThursdayNIU2",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:30:18 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:30:24 UTC")))
Thursday_NIU2_Run16_3  <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run16_3", groupID = "ThursdayNIU2",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:30:52 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:30:58 UTC")))

Thursday_NIU2_Run16 <- rbind(Thursday_NIU2_Run16_1,
                             Thursday_NIU2_Run16_2,
                             Thursday_NIU2_Run16_3)
Thursday_NIU2_Run16 %>%
  select(truth, movement_type) %>%
  irr::agree(.)

lineFMPPlot(Thursday_NIU2_Run16_3, drillType = "linear")
```

# ThursdayNIU2 Run 18 m / 3 sec

```{r}
Thursday_NIU2_Run18_1 <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run18_1", groupID = "ThursdayNIU2",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:32:55 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:33:01 UTC")))

Thursday_NIU2_Run18_2  <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run18_2", groupID = "ThursdayNIU2",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:33:31 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:33:37 UTC")))
Thursday_NIU2_Run18_3  <- LinearFMPtruth(ThursdayNIU2gps, FMPThursdayNIU2,
                                        event = "Run18_3", groupID = "ThursdayNIU2",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 08:34:07 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 08:34:13 UTC")))

Thursday_NIU2_Run18 <- rbind(Thursday_NIU2_Run18_1,
                             Thursday_NIU2_Run18_2,
                             Thursday_NIU2_Run18_3)
Thursday_NIU2_Run18 %>%
  select(truth, movement_type) %>%
  irr::agree(.)

lineFMPPlot(Thursday_NIU2_Run18_3, drillType = "linear")
```


# ThursdayNIU3 Run 15m / 3 sec

```{r}
Thursday_NIU3_Run15_1 <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run15_1", groupID = "ThursdayNIU3",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:10:16 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:10:22 UTC")))

Thursday_NIU3_Run15_2  <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run15_2", groupID = "ThursdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:10:49 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:10:55 UTC")))

Thursday_NIU3_Run15_3  <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run15_3", groupID = "ThursdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:11:18 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:11:24 UTC")))


Thursday_NIU3_Run15 <- rbind(Thursday_NIU3_Run15_1,
                             Thursday_NIU3_Run15_2,
                             Thursday_NIU3_Run15_3)

Thursday_NIU3_Run15 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Thursday_NIU3_Run15_3, drillType = "linear")

```


# ThursdayNIU3 Run 16.5 / 3 sec

```{r}
Thursday_NIU3_Run16_1 <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run16_1", groupID = "ThursdayNIU3",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:13:48 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:13:54 UTC")))

Thursday_NIU3_Run16_2  <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run16_2", groupID = "ThursdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:14:25 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:14:31 UTC")))

Thursday_NIU3_Run16_3  <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run16_3", groupID = "ThursdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:15:10 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:15:16 UTC")))


Thursday_NIU3_Run16 <- rbind(Thursday_NIU3_Run16_1,
                             Thursday_NIU3_Run16_2,
                             Thursday_NIU3_Run16_3)

Thursday_NIU3_Run16 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Thursday_NIU3_Run16_3, drillType = "linear")
```

# ThursdayNIU3 Run 18 / 3sec

```{r}
Thursday_NIU3_Run18_1 <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run18_1", groupID = "ThursdayNIU3",
                          startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:17:31 UTC")),
                          endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:17:37 UTC")))

Thursday_NIU3_Run18_2  <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run18_2", groupID = "ThursdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:18:10 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:18:16 UTC")))

Thursday_NIU3_Run18_3  <- LinearFMPtruth(ThursdayNIU3gps, FMPThursdayNIU3, 
                                        event = "Run18_3", groupID = "ThursdayNIU3",
                           startTime = as.numeric(lubridate::as_datetime("2022-02-17 11:18:53 UTC")),
                           endTime = as.numeric(lubridate::as_datetime("2022-02-17 11:18:59 UTC")))


Thursday_NIU3_Run18 <- rbind(Thursday_NIU3_Run18_1,
                             Thursday_NIU3_Run18_2,
                             Thursday_NIU3_Run18_3)

Thursday_NIU3_Run18 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Thursday_NIU3_Run18_3, drillType = "linear")
```


# All Walk

```{r}
Walk <- rbind(Tuesday_NIU2_Walk,
              Tuesday_NIU3_Walk)

Walk %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)

lineFMPPlot(Walk, drillType = "linear")
```

# All 10 m / 3 sec

```{r}
Run10 <- rbind(Tuesday_NIU2_Run10,
               Tuesday_NIU3_Run10,
               Wednesday_NIU1_Run10)

Run10 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)
```

# All 15 m / 3 sec

```{r}
Run15 <- rbind(Tuesday_NIU2_Run15,
               Tuesday_NIU3_Run15,
               Wednesday_NIU1_Run15,
               Thursday_NIU2_Run15,
               Thursday_NIU3_Run15)

Run15 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)


lineFMPPlot(Tuesday_NIU2_Run15 %>% filter(event == "Run15_2"), 
            drillType = "linear")
```

# All 16.5 m / 3 sec

```{r}
Run16 <- rbind(Wednesday_NIU1_Run16,
               Thursday_NIU2_Run16,
               Thursday_NIU3_Run16)

Run16 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)


lineFMPPlot(Thursday_NIU2_Run16 %>% filter(event == "Run16_2"), 
            drillType = "linear")
```

# All 18m / 3 sec

```{r}
Run18 <- rbind(Wednesday_NIU1_Run18,
               Thursday_NIU2_Run18,
               Thursday_NIU3_Run18)

Run18 %>% 
  select(truth, movement_type) %>% 
  irr::agree(.)


lineFMPPlot(Thursday_NIU2_Run18 %>% filter(event == "Run18_2"), 
            drillType = "linear")
```

